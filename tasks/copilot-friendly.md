````markdown
### Goal
Generate or update repository-wide Copilot context files that capture:

* Stack (Python version, env manager)
* Code style tools (Black, Ruff, isort, Flake8, …)
* Project layout (src/, scripts/, tests/, …)
* Testing conventions
* Shell best-practices
* A placeholder “Refactoring guidance” section

### Steps
1. **Walk all files in the workspace**.
   * Inspect `pyproject.toml`, `requirements*.txt`, `Pipfile`, or `conda.yaml` to infer the supported Python version and dependency manager.
   * Detect linters/formatters from config files (`pyproject.toml`, `.flake8`, `ruff.toml`, `.isort.cfg`, `setup.cfg`).
   * Identify directory conventions: `src/`, `app/`, `scripts/`, `tests/`, `bin/`, etc.
   * Parse the first five lines of every `*.sh` for shebangs and `set -euo pipefail`.

2. **Compose the following Markdown**, substituting the detected values:
   ```markdown
   <!-- Automatically generated by Copilot Chat -->
   ### Stack
   * Code must run on **Python <detected>**.

   ### Code style
   * <comma-separated list of linters/formatters>

   ### Project layout
   * <one bullet per convention>

   ### Testing
   * Unit tests with **pytest**.

   ### Shell best-practices
   * <bullets about shell dialect and safety flags>

   ### Refactoring guidance
   * _(Add architectural notes here.)_
````

3. **Write (or patch) the file** at `.github/copilot-instructions.md`.

4. **If no prompt files exist**, create `.github/prompts/skeleton.prompt.md` with:

   ```markdown
   ### Goal
   (Describe the refactor or migration task.)

   ### Steps
   1. …
   2. …

   ### References
   #file:src/path/to/relevant_file.py
   ```

### Output

* Show a unified diff of any file changes.
* List the files created or updated.

### References

@workspace

```
